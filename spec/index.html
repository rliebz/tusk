<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>The Spec - tusk</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">


    <link href="../pygments.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="..">tusk</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Getting Started</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">The Spec</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/rliebz/tusk"><i class="fa fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#the-spec">The Spec</a></li>
            <li class="second-level"><a href="#tasks">Tasks</a></li>
                
            <li class="second-level"><a href="#run">Run</a></li>
                
                <li class="third-level"><a href="#command">Command</a></li>
                <li class="third-level"><a href="#set-environment">Set Environment</a></li>
                <li class="third-level"><a href="#sub-tasks">Sub-Tasks</a></li>
            <li class="second-level"><a href="#when">When</a></li>
                
                <li class="third-level"><a href="#when-anyall-logic">When Any/All Logic</a></li>
            <li class="second-level"><a href="#args">Args</a></li>
                
                <li class="third-level"><a href="#arg-values">Arg Values</a></li>
            <li class="second-level"><a href="#options">Options</a></li>
                
                <li class="third-level"><a href="#option-types">Option Types</a></li>
                <li class="third-level"><a href="#option-defaults">Option Defaults</a></li>
                <li class="third-level"><a href="#option-values">Option Values</a></li>
                <li class="third-level"><a href="#required-options">Required Options</a></li>
                <li class="third-level"><a href="#private-options">Private Options</a></li>
                <li class="third-level"><a href="#shared-options">Shared Options</a></li>
            <li class="second-level"><a href="#finally">Finally</a></li>
                
            <li class="second-level"><a href="#cli-metadata">CLI Metadata</a></li>
                
            <li class="second-level"><a href="#interpolation">Interpolation</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h2 id="the-spec">The Spec</h2>
<h3 id="tasks">Tasks</h3>
<p>The core of every <code>tusk.yml</code> file is a list of tasks. Tasks are declared at the
top level of the <code>tusk.yml</code> file and include a list of tasks.</p>
<p>For the following tasks:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, world!&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">goodbye</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Goodbye, world!&quot;</span>
</pre></div>


<p>The commands can be run with no additional configuration:</p>
<div class="codehilite"><pre><span></span>$ tusk hello
Running: echo &quot;Hello, world!&quot;
Hello, world!
</pre></div>


<p>Tasks can be documented with a one-line <code>usage</code> string and a slightly longer
<code>description</code>. This information will be displayed in help messages:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Say hello to the world</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
      <span class="no">This command will echo &quot;Hello, world!&quot; to the user. There&#39;s no</span>
      <span class="no">surprises here.</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, world!&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">goodbye</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Goodbye, world!&quot;</span>
</pre></div>


<h3 id="run">Run</h3>
<p>The behavior of a task is defined in its <code>run</code> clause. A <code>run</code> clause can be
used for commands, sub-tasks, or setting environment variables. Although each
<code>run</code> item can only perform one of these actions, they can be run in succession
to handle complex scenarios.</p>
<h4 id="command">Command</h4>
<p>In its simplest form, <code>run</code> can be given a string or list of strings to be
executed serially as shell commands:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello!&quot;</span>
</pre></div>


<p>This is a shorthand syntax for the following:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello!&quot;</span>
</pre></div>


<p>If any of the run commands execute with a non-zero exit code, Tusk will
immediately exit with the same exit code without executing any other commands.</p>
<p>For executing shell commands, the interpreter used will be the value of the
<code>SHELL</code> environment variable. If no environment variable is set, the default is
<code>sh</code>.</p>
<h4 id="set-environment">Set Environment</h4>
<p>The second type of action a <code>run</code> clause can perform is setting or unsetting
environment variables. To do so, simply define a map of environment variable
names to their desired values:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">proxy-url</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">http://proxy.example.com</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set-environment</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">http_proxy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">${proxy-url}</span>
          <span class="l l-Scalar l-Scalar-Plain">https_proxy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">${proxy-url}</span>
          <span class="l l-Scalar l-Scalar-Plain">no_proxy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">~</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">curl http://example.com</span>
</pre></div>


<p>Passing <code>~</code> or <code>null</code> to an environment variable will explicitly unset it, while
passing an empty string will set it to an empty string.</p>
<h4 id="sub-tasks">Sub-Tasks</h4>
<p>Run can also execute previously-defined tasks:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">one</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Inside one&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">two</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">one</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Inside two&quot;</span>
</pre></div>


<p>For any arg or option that a sub-task defines, the parent task can pass a
value, which is treated the same way as passing by command-line would be. Args
are passed in as a list, while options are a map from flag name to value.</p>
<p>To pass values, use the long definition of a sub-task:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">args</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The person to greet</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">greeting</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;${greeting}, ${person}!&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">greet-myself</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">greet</span>
        <span class="l l-Scalar l-Scalar-Plain">args</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">me</span>
        <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">greeting</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Howdy</span>
</pre></div>


<p>In cases where a sub-task may not be useful on its own, define it as private to
prevent it from being invoked directly from the command-line. For example:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">configure-environment</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">private</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">set-environment</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">APP_ENV</span><span class="p p-Indicator">:</span> <span class="nv">dev</span><span class="p p-Indicator">}</span>
  <span class="l l-Scalar l-Scalar-Plain">serve</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">configure-environment</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">python main.py</span>
</pre></div>


<h3 id="when">When</h3>
<p>For conditional execution, <code>when</code> clauses are available.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
  <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;This is a linux machine&quot;</span>
</pre></div>


<p>In a <code>run</code> clause, any item with a true <code>when</code> clause will execute. There are
five different checks supported:</p>
<ul>
<li><code>command</code> (list): Execute if any command runs with an exit code of <code>0</code>.
  Commands will execute in the order defined and stop execution at the first
  successful command.</li>
<li><code>exists</code> (list): Execute if any file listed exists.</li>
<li><code>os</code> (list): Execute if the operating system matches any one from the list.</li>
<li><code>environment</code> (map[string -&gt; list]): Execute if the environment variable
  matches any of the values it maps to. To check if a variable is not set, the
  value should be <code>~</code> or <code>null</code>.</li>
<li><code>equal</code> (map[string -&gt; list]): Execute if the given option equals any of the
  values it maps to.</li>
<li><code>not-equal</code> (map[string -&gt; list]): Execute if the given option is not equal to
  any one of the values it maps to.</li>
</ul>
<p>The <code>when</code> clause supports any number of different checks as a list, where each
check must pass individually for the clause to evaluate to true. Here is a more
complicated example of how <code>when</code> can be used:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">echo</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">cat</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Cat a file</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">darwin</span>
        <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;This is a unix machine&quot;</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">exists</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">my_file.txt</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">cat</span><span class="p p-Indicator">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">command -v cat</span>
        <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cat my_file.txt</span>
</pre></div>


<h4 id="when-anyall-logic">When Any/All Logic</h4>
<p>A <code>when</code> clause takes a list of items, where each item can have multiple checks.
Each <code>when</code> item will pass if <em>any</em> of the checks pass, while the whole clause
will only pass if <em>all</em> of the items pass. These properties can be combined for
more complicated logic:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">echo</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">verbose</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bool</span>
      <span class="l l-Scalar l-Scalar-Plain">ignore-os</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bool</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="c1"># (OS is linux OR darwin OR ignore OS is true) AND (verbose is true)</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">darwin</span>
            <span class="l l-Scalar l-Scalar-Plain">equal</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">ignore-os</span><span class="p p-Indicator">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">equal</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">verbose</span><span class="p p-Indicator">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
        <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;This is a unix machine&quot;</span>
</pre></div>


<h3 id="args">Args</h3>
<p>Tasks may have args that are passed directly as inputs. Any arg that is defined
is required for the task to execute.</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">args</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The person to greet</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, ${name}!&quot;</span>
</pre></div>


<p>The task can be invoked as such:</p>
<div class="codehilite"><pre><span></span>$ tusk greet friend
Hello, friend!
</pre></div>


<h4 id="arg-values">Arg Values</h4>
<p>Args can specify which values are considered valid:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">args</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">values</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Abby</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Bobby</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Carl</span>
</pre></div>


<p>Any value passed by command-line must be one of the listed values, or the
command will fail to execute.</p>
<h3 id="options">Options</h3>
<p>Tasks may have options that are passed as GNU-style flags. The following
configuration will provide <code>-n, --name</code> flags to the CLI and help documentation,
which will then be interpolated:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The person to greet</span>
        <span class="l l-Scalar l-Scalar-Plain">short</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">n</span>
        <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">GREET_NAME</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">World</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, ${name}!&quot;</span>
</pre></div>


<p>The above configuration will evaluate the value of <code>name</code> in order of highest
priority:</p>
<ol>
<li>The value passed by command line flags (<code>-n</code> or <code>--name</code>)</li>
<li>The value of the environment variable (<code>GREET_NAME</code>), if set</li>
<li>The value set in default</li>
</ol>
<p>For short flag names, values can be combined such that <code>tusk foo -ab</code> is exactly
equivalent to <code>tusk foo -a -b</code>.</p>
<h4 id="option-types">Option Types</h4>
<p>Options can be of the types <code>string</code>, <code>integer</code>, <code>float</code>, or <code>boolean</code>, using
the zero-value of that type as the default if not set. Options without types
specified are considered strings.</p>
<p>For boolean values, the flag should be passed by command line without any
arugments. In the following example:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">loud</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bool</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">equal</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">loud</span><span class="p p-Indicator">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
        <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;HELLO!&quot;</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">equal</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span><span class="nv">loud</span><span class="p p-Indicator">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
        <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello.&quot;</span>
</pre></div>


<p>The flag should be passed as such:</p>
<div class="codehilite"><pre><span></span>tusk greet --loud
</pre></div>


<p>This means that for an option that is true by default, the only way to disable
it is with the following syntax:</p>
<div class="codehilite"><pre><span></span>tusk greet --loud<span class="o">=</span><span class="nb">false</span>
</pre></div>


<p>Of course, options can always be defined in the reverse manner to avoid this
issue:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">no-loud</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bool</span>
</pre></div>


<h4 id="option-defaults">Option Defaults</h4>
<p>Much like <code>run</code> clauses accept a shorthand form, passing a string to <code>default</code>
is shorthand. The following options are exactly equivalent:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">short</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">foo</span>
  <span class="l l-Scalar l-Scalar-Plain">long</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">foo</span>
</pre></div>


<p>A <code>default</code> clause can also register the <code>stdout</code> of a command as its value:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">uname -s</span>
</pre></div>


<p>A <code>default</code> clause also accepts a list of possible values with a corresponding
<code>when</code> clause. The first <code>when</code> that evaluates to true will be used as the
default value, with an omitted <code>when</code> always considered true.</p>
<p>In this example, linux users will have the name <code>Linux User</code>, while the default
for all other OSes is <code>User</code>:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
        <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Linux User</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">User</span>
</pre></div>


<h4 id="option-values">Option Values</h4>
<p>Like args, an option can specify which values are considered valid:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">number</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">zero</span>
    <span class="l l-Scalar l-Scalar-Plain">values</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">one</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">two</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">three</span>
</pre></div>


<p>Any value passed by command-line flags or environment variables must be one of
the listed values. Default values, including commands, are excluded from this
requirement.</p>
<h4 id="required-options">Required Options</h4>
<p>Options may be required if there is no sane default value. For a required flag,
the task will not execute unless the flag is passed:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">file</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>


<p>A required option cannot be private or have any default values.</p>
<h4 id="private-options">Private Options</h4>
<p>Sometimes it may be desirable to have a variable that cannot be directly
modified through command-line flags. In this case, use the <code>private</code> option:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">private</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">whoami</span>
</pre></div>


<p>A private option will not accept environment variables or command line flags,
and it will not appear in the help documentation.</p>
<h4 id="shared-options">Shared Options</h4>
<p>Options may also be defined at the root of the config file to be shared between
tasks:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The person to greet</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">World</span>

<span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello, ${name}!&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">goodbye</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Goodbye, ${name}!&quot;</span>
</pre></div>


<p>Any shared variables referenced by a task will be exposed by command-line when
invoking that task. Shared variables referenced by a sub-task will be evaluated
as needed, but not exposed by command-line.</p>
<p>Tasks that define an argument or option with the same name as a shared task will
overwrite the value of the shared option for the length of that task, not
including sub-tasks.</p>
<h3 id="finally">Finally</h3>
<p>The <code>finally</code> clause is run after a task's <code>run</code> logic has completed, whether or
not that task was successful. This can be useful for clean-up logic. A <code>finally</code>
clause has the same format as a <code>run</code> clause:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">hello</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Hello&quot;</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">exit 1</span>          <span class="c1"># `run` clause stops here</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Oops!&quot;</span>    <span class="c1"># Never prints</span>
    <span class="l l-Scalar l-Scalar-Plain">finally</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;Goodbye&quot;</span>  <span class="c1"># Always prints</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cleanup</span>
  <span class="c1"># ...</span>
</pre></div>


<p>If the <code>finally</code> clause runs an unsuccessful command, it will terminate early
the same way that a <code>run</code> clause would. The exit code is still passed back to
the command line. However, if both the <code>run</code> clause and <code>finally</code> clause fail,
the exit code from the <code>run</code> clause takes precedence.</p>
<h3 id="cli-metadata">CLI Metadata</h3>
<p>It is also possible to create a custom CLI tool for use outside of a project's
directory by using shell aliases:</p>
<div class="codehilite"><pre><span></span><span class="nb">alias</span> <span class="nv">mycli</span><span class="o">=</span><span class="s2">&quot;tusk -f /path/to/tusk.yml&quot;</span>
</pre></div>


<p>In that case, it may be useful to override the tool name and usage text that
are provided as part of the help documentation:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mycli</span>
<span class="l l-Scalar l-Scalar-Plain">usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">A custom aliased command-line application</span>

<span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>


<p>The example above will produce the following help documentation:</p>
<div class="codehilite"><pre><span></span>mycli - A custom aliased command-line application

Usage:
  mycli [global options] &lt;task&gt; [task options]

Tasks:
  ...
</pre></div>


<h3 id="interpolation">Interpolation</h3>
<p>The interpolation syntax for a variable <code>foo</code> is <code>${foo}</code>, meaning any instances
of <code>${foo}</code> in the configuration file will be replaced with the value of <code>foo</code>
during execution.</p>
<p>Interpolation is done on a task-by-task basis, meaning args and options defined
in one task will not interpolate to any other tasks. Shared options, on the
other hand, will only be evaluated once per execution.</p>
<p>The execution order is as followed:</p>
<ol>
<li>Shared options are interpolated first, in the order defined by the config
   file. The results of global interpolation are cached and not re-run.</li>
<li>The args for the current task being run are interpolated, in order.</li>
<li>The options for the current task being run are interpolated, in order.</li>
<li>For each call to a sub-task, the process is repeated, ignoring the task-
   specific interpolations for parent tasks, using the cached shared options.</li>
</ol>
<p>This means that options can reference other options or args:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">World</span>
  <span class="l l-Scalar l-Scalar-Plain">greeting</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello, ${name}</span>

<span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">greet</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;${greeting}&quot;</span>
</pre></div>


<p>Because interpolation is not always desirable, as in the case of environment
variables, <code>$$</code> will escape to <code>$</code> and ignore interpolation. It is also
possible to use alternative syntax such as <code>$foo</code> to avoid interpolation as
well. The following two tasks will both use environment variables and not
attempt interpolation:</p>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">one</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello, $${USER}</span>
  <span class="l l-Scalar l-Scalar-Plain">two</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Hello, $USER</span>
</pre></div>


<p>Interpolation works by substituting the value in the <code>yaml</code> config file, then
parsing the file after interpolation. This means that variable values with
newlines or other characters that are relevant to the <code>yaml</code> spec or the <code>sh</code>
interpreter will need to be considered by the user. This can be as simple as
using quotes when appropriate.</p></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>
    <script src="../search/require.js"></script>
    <script src="../search/search.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
